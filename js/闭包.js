闭包是函数 + 函数能够访问其外部作用域变量的组合。

闭包就是：一个函数“记住”了它外部的变量，即使外部函数已经执行完。
闭包要的是：作用域还活着

闭包的作用
1. 私有变量
2. 做封装（模块化）
3. 缓存（记忆函数）

闭包容易踩的坑
1. 循环 + var
  for (var i = 0; i < 3; i++) {
    setTimeout(() => console.log(i), 100);
  }
  // 333,因为所有回调共享一个 i。
  // 用 let（块级作用域）
  for (let i = 0; i < 3; i++) {
    setTimeout(() => console.log(i), 100);
  }
ES6 for 循环配合 let 时，JavaScript 会为每次循环创建一个新的词法环境，一个环境里包含一个新的 i。

从 V8 和规范角度：
普通返回对象：
  只是引用传递
  执行上下文完全销毁
  无 [[Environment]] 绑定
  无闭包作用域创建

闭包：
  创建 Closure Scope 对象：V8 创建的特殊对象，保存被内部函数引用的外部变量
  外部词法环境被保留
  函数有 [[Environment]] 内部属性
  实现了"函数记住创建时的作用域"

闭包的核心机制（词法环境保留和 [[Environment]] 绑定）

概念             作用                何时创建             包含什么
执行上下文        代码执行的环境        代码执行时           词法环境、变量环境、this 
词法环境          标识符与变量的映射     执行上下文创建时       环境记录、外部引用
变量环境存储       var 声明            执行上下文创建时      var变量和函数声明
环境记录          实际存储变量的地方     词法环境创建时        变量、函数
作用域链          变量查找路径          函数定义时确定        一系列词法环境
Closure Scope   闭包保存的变量         返回内部函数时        被引用的外部变量
